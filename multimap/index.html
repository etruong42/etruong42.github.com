<html>
<head>
<link rel="stylesheet" href="../assets/css/bootstrap.css">
<link rel="stylesheet" href="../assets/css/global.css">

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" ></script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>

<script type="text/javascript">
function init() {
	$("#btnCalculate").click(calculateDistances);
	$(".displayhint").mouseenter(function() {
		$(this).next().removeClass('hide');
	});
	$(".displayhint").mouseout(function() {
		$(this).next().addClass('hide');
	});
}

function calculateDistances() {
	var elOrigin = $("#origin");
	var elDestinations = $("#destinations");
	var service = new google.maps.DistanceMatrixService();
	service.getDistanceMatrix(
	{
		origins: [elOrigin.val()],
		destinations: elDestinations.val().split("\n"),
		travelMode: google.maps.TravelMode.WALKING,
		avoidHighways: false,
		avoidTolls: false
	}, displayDistances);
}
var glob;
function displayDistances(response, status) {
	var elResults = $("#results");
	elResults.html("");
	if (status === google.maps.DistanceMatrixStatus.OK) {
		glob = response;
		var origins = response.originAddresses;
		var destinations = response.destinationAddresses;

		for (var i = 0; i < origins.length; i++) {
			var results = response.rows[i].elements;
			
			for (var j = 0; j < results.length; j++) {
				var element = results[j];
				var distance = element.distance.text;
				var duration = element.duration.text;
				var from = origins[i];
				var to = destinations[j];
				elResults.html(elResults.html() 
					+ "<p><strong>" + from + "</strong> to <strong>" + to + "</strong> " + distance + "</p>");
			}
		}
	}
}

window.onload = init;
</script>

</head>

<body>
<div class="container">
	<div class="page-header">
		<h1>Multimap <small>Quickly compare route distances</small></h1>
	</div>
	<div class="row">
		<div class="span16">
			<form class="form-stacked">
				<fieldset>
				<div class="clearfix">
					<label for="origin">Origin</label>
					<div class="input">
						<input class="span6 displayhint" id="origin" name="origin" value="212 Elm St, Somerville, MA" type="text">
						<span class="help-inline hide">Enter your starting address</span>
					</div>
					
				</div>
				<div class="clearfix">
					<label for="destinations">Destinations</label>
					<textarea class="span6 displayhint" rows="10" id="destinations">
White House
Mount Rushmore
Monticello</textarea>
					<span class="help-inline hide">Enter your destinations</span>
				</div>
				</fieldset>
				<button type="button" class="btn" id="btnCalculate">Calculate Distances</button>
				
			</form>
			
		</div>
	</div>
	<div class="row">
		<div class="span16" id="results"></td>
	</div>
</div>
</body>
</html>